
<script>
  const courseSelect = document.getElementById("courseSelect");
  const provinceSelect = document.getElementById("provinceSelect");
  const townSelect = document.getElementById("townSelect");
  const result = document.getElementById("result");
  const courseSearch = document.getElementById("courseSearch");

  const nextBtn = document.getElementById("nextBtn");
  const backBtn = document.getElementById("backBtn");

  let step = 1;

  function populateCourseOptions(filter = "") {
    courseSelect.innerHTML = '<option value="">Select a Course</option>';
    Object.keys(courseIndustryMap).forEach(course => {
      if (course.toLowerCase().includes(filter.toLowerCase())) {
        const option = document.createElement("option");
        option.value = course;
        option.textContent = course;
        courseSelect.appendChild(option);
      }
    });
  }

  courseSearch.addEventListener("input", () => {
    populateCourseOptions(courseSearch.value);
  });

  populateCourseOptions();

  nextBtn.addEventListener("click", () => {
    if (step === 1) {
      const selectedCourse = courseSelect.value;
      if (!selectedCourse) return alert("Please select a course.");
      provinceSelect.innerHTML = '<option value="">Select a Province</option>';
      Object.keys(provinceTowns).forEach(province => {
        const option = document.createElement("option");
        option.value = province;
        option.textContent = province;
        provinceSelect.appendChild(option);
      });
      courseSelect.classList.add("hidden");
      courseSearch.classList.add("hidden");
      provinceSelect.classList.remove("hidden");
      backBtn.classList.remove("hidden");
      result.innerHTML = "";
      step = 2;
    } else if (step === 2) {
      const selectedProvince = provinceSelect.value;
      if (!selectedProvince) return alert("Please select a province.");
      const towns = provinceTowns[selectedProvince] || [];
      townSelect.innerHTML = '<option value="">Select a Town</option>';
      towns.forEach(town => {
        const option = document.createElement("option");
        option.value = town;
        option.textContent = town;
        townSelect.appendChild(option);
      });
      provinceSelect.classList.add("hidden");
      townSelect.classList.remove("hidden");
      result.innerHTML = "";
      nextBtn.textContent = "Show Results";
      step = 3;
    } else if (step === 3) {
      const selectedCourse = courseSelect.value;
      const selectedProvince = provinceSelect.value;
      const selectedTown = townSelect.value;
      if (!selectedTown) return alert("Please select a town.");
      const industries = courseIndustryMap[selectedCourse] || [];
      const mapLinks = industries.map(industry =>
        `<a href="https://www.google.com/maps/search/${encodeURIComponent(industry + ' in ' + selectedTown + ', ' + selectedProvince)}" target="_blank">${industry}</a>`
      );
      result.innerHTML = `Internship Locations in <strong>${selectedTown}, ${selectedProvince}</strong> for <strong>${selectedCourse}</strong>:<br>${mapLinks.join("<br>")}`;
      nextBtn.classList.add("hidden");
    }
  });

  backBtn.addEventListener("click", () => {
    if (step === 2) {
      provinceSelect.classList.add("hidden");
      courseSelect.classList.remove("hidden");
      courseSearch.classList.remove("hidden");
      backBtn.classList.add("hidden");
      result.innerHTML = "";
      step = 1;
    } else if (step === 3) {
      townSelect.classList.add("hidden");
      provinceSelect.classList.remove("hidden");
      result.innerHTML = "";
      nextBtn.classList.remove("hidden");
      nextBtn.textContent = "Next";
      step = 2;
    }
  });
</script>
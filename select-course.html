<!DOCTYPE html>
<html>
<head>
  <title>Select Course</title>
  <script src="data.js"></script>
  <style>
    body { font-family: Arial; padding: 20px; }
    input { padding: 10px; width: 100%; margin-bottom: 20px; }
    select, h2, h3, p { margin-bottom: 15px; }
    .location-link { display: block; margin-left: 20px; }
  </style>
</head>
<body>
  <h1>Select a Course</h1>
  <input type="text" id="search" placeholder="Search courses...">
  <select id="courseSelect" onchange="displayLocations()">
    <option value="">-- Choose a Course --</option>
  </select>

  <div id="results"></div>

  <script>
    const searchInput = document.getElementById("search");
    const courseSelect = document.getElementById("courseSelect");
    const resultsDiv = document.getElementById("results");

    Object.keys(courseIndustryMap).forEach(course => {
      const option = document.createElement("option");
      option.value = course;
      option.textContent = course;
      courseSelect.appendChild(option);
    });

    searchInput.addEventListener("input", () => {
      const filter = searchInput.value.toLowerCase();
      Array.from(courseSelect.options).forEach(opt => {
        opt.style.display = opt.value.toLowerCase().includes(filter) || opt.value === "" ? "block" : "none";
      });
    });

    function displayLocations() {
      resultsDiv.innerHTML = "";
      const selectedCourse = courseSelect.value;
      if (!selectedCourse) return;

      const industries = courseIndustryMap[selectedCourse];

      Object.entries(provinceTowns).forEach(([province, towns]) => {
        const provinceHeading = document.createElement("h2");
        provinceHeading.textContent = province;
        resultsDiv.appendChild(provinceHeading);

        towns.forEach(town => {
          const townHeading = document.createElement("h3");
          townHeading.textContent = town;
          resultsDiv.appendChild(townHeading);

          industries.forEach(industry => {
            const link = document.createElement("a");
            link.href = `https://www.google.com/maps/search/${encodeURIComponent(industry + " in " + town + ", " + province + ", South Africa")}`;
            link.target = "_blank";
            link.textContent = `${industry}`;
            link.className = "location-link";
            resultsDiv.appendChild(link);
          });
        });
      });
    }
  </script>
</body>
</html>